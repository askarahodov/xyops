# Добро пожаловать в xyOps!

xyOps - это планировщик задач, движок автоматизации рабочих процессов и платформа мониторинга серверов. Он позволяет запускать задачи на ваших серверах, визуально оркестрировать их с помощью workflows, собирать метрики, запускать по расписанию или интервалам и реагировать с помощью actions и limits. Все доступно в веб-интерфейсе и через REST API.

Это руководство показывается при первом входе, чтобы помочь сделать первые шаги и познакомить с базовыми концепциями. Вернуться к нему можно в любое время, нажав "Documentation" в боковой панели, затем "Welcome to xyOps".


## Шаг 1: Добавьте сервер

Прежде чем что-либо запускать, добавьте хотя бы один сервер. Серверы запускают легковесный агент xySat и выполняют задачи, отправленные xyOps. Вы можете добавлять Docker, Linux, macOS или Windows хосты.

Добавьте сервер через UI:

1. Откройте страницу Servers и нажмите "Add Server".
2. При желании задайте метку, иконку и группы или оставьте значения по умолчанию.
3. Скопируйте однострочную команду установки для вашей ОС и выполните ее на целевом хосте.
4. Сервер появится в UI, начнет стримить метрики и будет готов запускать задачи.

Для автоматизированного провижининга можно передать API ключ при первом запуске. См. [Servers](servers.md).


## Основные понятия: Events и Workflows

- **Events**: событие определяет что запускать (плагин плюс параметры), где запускать (серверы или группы), когда запускать (triggers) и как управлять и реагировать (limits и actions). Каждый запуск события создает задачу (job). См. [Events](events.md).
- **Workflows**: workflow - это визуальный граф, который связывает задачи управляющими связями. Запуск workflow становится родительской задачей, которая запускает подзадачи на узлах. Можно распараллеливать, объединять, повторять, мультиплексировать по серверам и задавать limits/actions на уровне узлов. См. [Workflows](workflows.md).

Большинство автоматизаций можно оставить простыми events. Используйте workflows, когда нужна оркестрация, ветвления или параллелизм.


## Triggers: когда запускаются задачи

Triggers управляют тем, когда события и workflows разрешено запускать. Частые случаи:

- **Manual**: запуск по требованию пользователем или через API.
- **Schedule**: расписание часов/минут/дней как в cron, с опциональными таймзонами.
- **Interval**: запуск каждые N секунд, начиная с заданного времени.
- **Single Shot**: запуск один раз в точное время.
- **Plugin**: кастомная логика триггера, предоставленная плагином.
- **Range and Blackout**: разрешить или запретить запуски в указанных временных диапазонах.
- **Options**: Catch-Up (догонять пропущенные расписания), Delay (отложить запуск), Precision (планирование с точностью до секунд).

Events показывают triggers в редакторе. Workflows показывают triggers как узлы графа, которые соединяются с входными узлами. См. [Triggers](triggers.md).


## Plugins: что запускается

Event Plugins - это код, который выполняет ваши задачи. Встроенные варианты:

- **Shell Plugin**: выполнение произвольных скриптов/команд shell.
- **HTTP Request Plugin**: вызовы HTTP(S) endpoints.
- **Docker Plugin**: запуск скриптов внутри контейнеров.
- **Test Plugin**: генерация тестовых данных/файлов для проверки сценариев.

Вы можете писать свои плагины на любом языке. Плагины читают JSON-контекст задачи из STDIN и пишут JSON-статусы в STDOUT. См. [Plugins](plugins.md).


## Actions и Limits

- **Limits**: самоограничения, такие как Max Run Time, Max Output Size, Max CPU/Memory, Max Concurrent Jobs, Max Queue и Max Retries. Limits могут применять теги, отправлять уведомления, делать снимки и при необходимости прерывать задачи. Limits наследуются из event/workflow, категории и глобальных значений. См. [Limits](limits.md).
- **Actions**: реакции на результат задачи (start, success, error, warning, critical, abort или tag match) или на изменение состояния алертов. Типы actions включают email, web hook, run job, ticket, snapshot и другие. Actions выполняются параллельно и дедуплицируются по целям. См. [Actions](actions.md).


## Categories

Categories помогают организовать события и управлять умолчаниями и видимостью. Категория может:

- Применять дефолтные actions и limits к событиям в категории.
- Контролировать доступ на основе ролей и привилегий пользователей.
- Удобно группировать связанную автоматизацию для команд.

Можно начать с категории по умолчанию и позже уточнить структуру. См. [Categories](categories.md).


## Попробуйте: ваше первое событие

1. Перейдите в Events -> New Event.
2. Введите заголовок и выберите категорию.
3. Выберите Shell Plugin и вставьте простой скрипт, например:

```sh
#!/bin/sh
echo "Hello from xyOps"
echo '{ "xy": 1, "code": 0 }'
```

Финальная JSON-строка сигнализирует об успехе для xyOps.

4. Выберите один из ваших серверов (или группу) как цель и оставьте алгоритм выбора по умолчанию.
5. Добавьте Manual trigger и сохраните событие.
6. Нажмите Run, смотрите лог в реальном времени и откройте результат и метрики задачи.

Далее попробуйте добавить limit Max Run Time и email action при ошибке. Перезапустите, чтобы увидеть поведение actions и limits.


## Попробуйте: ваш первый workflow

1. Перейдите в Workflows -> New Workflow.
2. Добавьте узел Trigger (Manual) и соедините его с узлом Event, который ссылается на созданное событие.
3. При желании вставьте Controller (например, Repeat или Multiplex) между trigger и event, чтобы увидеть параллелизм.
4. Прикрепите узел Limit (например, Max Concurrent Jobs) к нижнему полю узла event.
5. Нажмите Test Selection или Run, затем изучите родительскую задачу workflow и ее подзадачи.

См. [Workflows](workflows.md) для типов узлов, контроллеров и инструментов редактирования графа.


## Куда двигаться дальше

- Добавьте больше серверов и организуйте их через группы. См. [Servers](servers.md) и [Groups](groups.md).
- Создавайте monitors и alerts для метрик серверов. См. [Monitors](monitors.md) и [Alerts](alerts.md).
- Переиспользуйте уведомления через channels. См. [Channels](channels.md).
- Делитесь данными и файлами между задачами через buckets. См. [Buckets](buckets.md).
- Изучайте продвинутое планирование, catch-up, диапазоны и blackout окна. См. [Triggers](triggers.md).
- Упаковывайте и публикуйте собственные плагины. См. [Plugins](plugins.md) и [Marketplace](marketplace.md).
- Нажмите ссылку "Documentation" в боковой панели для полного указателя.

Есть вопросы или обратная связь? См. наш [Support Guide](support.md).
